<dom-module id="br-form">

<template>
  <form method="post" on-input="_checkValidity" novalidate>

    <content></content>

  </form>

</template>

<script>
  Polymer({
    is: 'br-form',

    properties: {
      buttonId: String,
      allBrInputElements: {
        type: Array,
        value: [],
        readOnly: true
      },
      inputCount: Number

    },

    ready: function(){
      var buttonSubmit = Polymer.dom(this).querySelector("#" + this.buttonId);

      buttonSubmit.setAttribute('disabled', true);

      this._setAllBrInputElements(Polymer.dom(this).querySelectorAll('br-input'));
      this.inputCount = this.allBrInputElements.length;
      
    },

    _checkValidity: function () {
      
      var buttonSubmit = Polymer.dom(this).querySelector("#" + this.buttonId);
      var count = 0;
      
      for (var i = 0; i < this.allBrInputElements.length; i++) {

        if (this.allBrInputElements[i].isValid === "true")
          count++;
      }

      console.log('Count is: ' + count +  ' Input Count is: ' + this.inputCount);

      if(count === this.inputCount){
        buttonSubmit.enable();
        buttonSubmit.removeAttribute('disabled');
      }
      else{
        buttonSubmit.disable();
        buttonSubmit.setAttribute('disabled', 'disabled');
      }


    }
  });
</script>

</dom-module>
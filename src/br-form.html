<dom-module id="br-form">

<template>
  <form method="post" on-input="_checkValidity" novalidate>

    <content></content>

  </form>

</template>

<script>
  Polymer({
    is: 'br-form',

    properties: {
      buttonId: String,
      allBrInputElements: {
        type: Array,
        value: [],
        readOnly: true
      },
      inputCount: Number

    },

    ready: function(){
      var buttonSubmit = Polymer.dom(this).querySelector("#" + this.buttonId);

      buttonSubmit.setAttribute('is-disabled', true);

      this._setAllBrInputElements(Polymer.dom(this).querySelectorAll('br-input'));
      this.inputCount = this.allBrInputElements.length;
      
    },

    _checkValidity: function () {
      
      var buttonSubmit = Polymer.dom(this).querySelector("#" + this.buttonId);
      var count = 0;
      
      for (var i = 0; i < this.allBrInputElements.length; i++) {

        console.log(this.allBrInputElements[i].isValidForm);
        if (this.allBrInputElements[i].isValidForm){
          count++;
        }
      }
      
      console.log(this.inputCount + ' / ' + count);

      if(count === this.inputCount){
        buttonSubmit.enable();
        buttonSubmit.removeAttribute('is-disabled');
      }
      else{
        buttonSubmit.disable();
        buttonSubmit.setAttribute('is-disabled', true);
      }


    }
  });
</script>

</dom-module>
<dom-module id="br-form">
  <template>
    <form method="post" id$="{{brId}}" on-input="_checkValidity" on-click="_checkValidity" novalidate>
      <content></content>
    </form>
  </template>
  <script>
    Polymer({
      is: 'br-form',

      properties: {
        buttonId: String,
        inputCount: Number,
        brId: String
      },

      listeners: {
        'on-item-selected': '_checkValidity'
      },

      ready: function () {

        this.allInputElements = [];

        var buttonSubmit = Polymer.dom(this).querySelector("#" + this.buttonId);

        buttonSubmit.setAttribute('is-disabled', true);

        var form = Polymer.dom(this.root).querySelector("#" + this.brId);

        this.allInputElements = form.querySelectorAll('br-input,br-select,br-radio-button,br-checkbox');

        this.inputCount = this.allInputElements.length;

        this.async(function(){
          this._checkValidity();
        },1);
      },      

      _checkValidity: function () {
        var buttonSubmit = Polymer.dom(this).querySelector("#" + this.buttonId);
        var count = 0;

        for (var i = 0; i < this.allInputElements.length; i++) {
          console.log(this.allInputElements[i].isValidForm);
          if (this.allInputElements[i].isValidForm)
            count++;
        }

        if (count === this.inputCount) {
          buttonSubmit.removeAttribute('is-disabled');
        }
        else {
          buttonSubmit.setAttribute('is-disabled', true);
        }
      }

    });
  </script>
</dom-module>